<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 Test</title>
        <script type="text/javascript" src="d3/d3.js"></script>
		<script type="text/javascript" src="util.js"></script>
        <style type="text/css">
			div.bar {
				display: inline-block;
				width: 20px;
				height: 75px;	/* Gets overriden by D3-assigned height below */
				margin-right: 2px;
				background-color: teal;
			}
		</style>
    </head>
    <body>
        <script type="text/javascript">
			var teamNames= ["ATL", "BRK", "CHA", "CHI", "DAL", "GSW", "HOU", "IND", "LAC", "MEM", "MIA", "OKC", "POR", "SAS", "TOR", "WAS"]
			var colors= {"ATL":"#D21033", "BOS":"#05854C", "BRK":"#000000", "CHA":"#F26532", "CHH":"#25799A", "CHI":"#D4001F", "CLE":"#9F1425", "DAL":"#006AB5", "DEN":"#4393D1", "DET":"#006BB6", "GSW":"#FFC33C", "HOU":"#CC0000", "IND":"#FFC225", "LAC":"#EE2944", "LAL":"#4A2583", "MEM":"#85A2C6", "MIA":"#B62630", "MIL":"#00330A", "MIN":"#EFEFEF", "NJN":"#002258", "NOH":"#0095CA", "NYK":"#2E66B2", "OKC":"#0075C1", "ORL":"#077ABD", "PHI":"#C7974D", "PHO":"#FF7A31", "POR":"#E1393E", "SAS":"#BEC8C9", "SAC":"#743389", "SEA":"#19542D", "TOR":"#CD1041", "UTA":"#448CCE", "WAS":"#004874"}
            //Width and height
            var w= 70*16+10;
            var h= 900;
            var mainR= w/12; //radius of main circle
            var distScale= 200
			var zoomRad= w/8;
			var offset= 15; 
			
			//Create SVG element
			var svg= d3.select("body")
						.append("svg")
						.attr("width", w)
						.attr("height", h);
						
			//create group for concentric axes
			var axes= svg.append("g")
						.attr("class", "axes")
			for (i=0; i<3; i++) {
				axes.append("ellipse")
					.attr("class","axes")
					.attr("cx",w/2)
					.attr("cy",h/2)
			}
		
			//load and display neighbor data
			d3.json("data.json", function(teamAndNeighs) {		
					
				//Create main circle
				sun= svg.append("g")
						.attr("class","sun")	
				sun.append("clipPath")
						.attr("class","sun")
						.attr("id","sun")
						.append("ellipse")
						.attr("cx",w/2)
						.attr("cy",h/2)
						.attr("rx",mainR)
						.attr("ry",mainR);
				sun.append("image")
						.attr("class","sun")
						.attr("x",w/2-100)
						.attr("y",h/2-100)
						.attr("width",200)
						.attr("height",200);
				
				
				//create top row of 2014 playoff teams
				toggle= svg.selectAll("g.toggle") //Add groups for each toggle button
							.data(teamAndNeighs)
							.enter()
							.append("g")
							.attr("class","toggle");
				toggle.append("circle") //Add circle to each group
					.attr("class","toggle")
					.attr("cx", function(d,i) {
								return 40 + 70*i;
							})
					.attr("cy", 80)
					.attr("r", 30)
					.attr("fill", function(d) {
								return (d.team in colors) ? colors[d.team] : "#000000";
							});	
				toggle.append("text") //Add text to each group
					.attr("class","toggle")
					.attr("x", function(d,i) {
								return 40 + 70*i;
							})
					.attr("y", 80)
					.attr("text-anchor", "middle")
					.attr("dominant-baseline","central")
					.attr("fill", "white")
					.text(function(d) { return d.team; });	
				toggle.on("mouseover",function() { //Add event handler to each GROUP (not each individual circle/text!)
									color= d3.select(this).select("circle").attr("fill");
									d3.select(this).select("circle").attr("stroke",d3.rgb(color).darker(1));
									d3.select(this).select("circle").attr("stroke-width","5");
								})
						.on("mouseout",function() {
										d3.select(this).select("circle").attr("stroke-width","0");
									})
						.on("click", function(d) {
										toggleOrbit(d);
									});
												
				//create groups for neighbor circles (planets)
				for (i = 0; i < 16; i++) {
					var orbGroup= svg.append("g")
									.attr("class","orbit");
					orbGroup.append("circle");
					txtGroup= orbGroup.append("svg");
					for (j=0; j<4; j++) {
						txtGroup.append("text");
					}
				}
			});
        </script>
    </body>
</html>